- replace deprecated gen_fsm to gen_statem

- finish test transformation to setup format and test generators
- write rest of unit tests for fsm